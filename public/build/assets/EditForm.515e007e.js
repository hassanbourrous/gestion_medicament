var N=Object.defineProperty,S=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var y=(t,s,a)=>s in t?N(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,x=(t,s)=>{for(var a in s||(s={}))D.call(s,a)&&y(t,a,s[a]);if(j)for(var a of j(s))L.call(s,a)&&y(t,a,s[a]);return t},P=(t,s)=>S(t,R(s));import{J as M}from"./Label.f2ea9d50.js";import{I as z}from"./InertiaButton.da879e12.js";import{J as O}from"./InputError.ef5e9aea.js";import{K as J,e as i,o as h,f as V,w as n,k as r,g as l,q as d,z as C,B as T,Y as q,C as v,j as K,i as A,l as Y,F as G,n as p}from"./vendor.7f465e53.js";import{a as H,b as Q,J as W}from"./JigTab.62d3a5bb.js";import{J as X}from"./Checkbox.aee54e1d.js";import{J as Z}from"./JigDatepicker.6ad0a203.js";import{J as $}from"./Input.b4df4bca.js";import{J as ee}from"./JigTextarea.fc585187.js";import{J as se}from"./SecondaryButton.bbf9bfb6.js";import oe from"./AssignEstab.76d8d3b0.js";import{_ as te}from"./plugin-vue_export-helper.5a098b48.js";import"./vue-flatpickr.min.4171e8ec.js";import"./main.d4931533.js";import"./DisplayMixin.328c366f.js";const re={name:"EditUsersForm",props:{model:Object,roles:Object,establishments:Object},components:{InertiaButton:z,JetLabel:M,JetInputError:O,JetInput:$,JigDatepicker:Z,JetCheckbox:X,JigTextarea:ee,JigTabLink:H,JigTabs:Q,JigTab:W,JetSecondaryButton:se,AssignEstab:oe},data(){return{form:J(P(x({},this.model),{assigned_roles:this.roles,password:null,password_confirmation:null}),{remember:!1}),activeTab:"basic-info",tabActiveClasses:"bg-primary font-bold text-secondary rounded-t-lg hover:bg-primary-500",photoPreview:null,photo_form:J({photo:null},{remember:!1}),photo:null}},mounted(){},computed:{flash(){return this.$page.props.flash||{}}},methods:{async updateModel(){this.form.put(this.route("admin.users.update",this.form.id),{onSuccess:t=>{this.flash.success?(this.updateUserPhoto(),this.clearPhotoFileInput(),this.$emit("success",this.flash.success)):this.flash.error?this.$emit("error",this.flash.error):this.$emit("error","Unknown server error.")},onError:t=>{this.$emit("error","A server error occurred")}},{remember:!1,preserveState:!0})},async toggleRole(t){const s=this;axios.post(this.route("api.users.assign-role",this.form.id),{role:t}).then(a=>{this.$inertia.reload({preserveState:!0}),this.displayNotification("success",a.data.message)}).catch(a=>{var b,e;this.displayNotification("error",((e=(b=a.response)==null?void 0:b.data)==null?void 0:e.message)||a.message||a),s.form.assigned_roles[t.name].checked=!t.checked})},updateUserPhoto(){if(this.$refs.photo&&this.$refs.photo.files[0]){let t=new FormData;t.append("photo",this.$refs.photo.files[0]),axios.post(route("api.users-photo.update",this.form.id),t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(s){this.clearPhotoFileInput()}).catch(function(){this.clearPhotoFileInput()})}},selectNewPhoto(){this.$refs.photo.click()},updatePhotoPreview(){const t=this.$refs.photo.files[0];if(!t)return;const s=new FileReader;s.onload=a=>{this.photoPreview=a.target.result},s.readAsDataURL(t)},deletePhoto(){this.form.profile_photo_path=null,this.form.profile_photo_url=null},clearPhotoFileInput(){var t;((t=this.$refs.photo)==null?void 0:t.value)&&(this.$refs.photo.value=null)}}},ae=p("Basic Info "),le=p("Assign Roles "),ne=p("Assign Establishments "),ie={class:"sm:col-span-4"},ce={class:"sm:col-span-4"},me={class:"sm:col-span-4"},de={class:"sm:col-span-4"},pe={class:"sm:col-span-4"},ue={class:"mt-2"},fe=["src","alt"],he={class:"mt-2"},be=p(" Select A New Photo "),_e=p(" Remove Photo "),ge={class:"mt-2 text-right"},ve=p("Submit"),we={class:"my-2 border rounded-md p-3"},ke=l("h3",{class:"font-bold py-3 text-lg"},"Assign Roles",-1),je=l("hr",null,null,-1),ye={class:"p-2 mt-2 border rounded"};function xe(t,s,a,b,e,c){const _=i("jig-tab-link"),m=i("jet-label"),u=i("jet-input"),f=i("jet-input-error"),w=i("jet-secondary-button"),I=i("inertia-button"),g=i("jig-tab"),U=i("jet-checkbox"),F=i("assign-estab"),B=i("jig-tabs");return h(),V(B,{class:d("border-none"),"nav-classes":"bg-secondary-300 rounded-t-lg border-b-4 border-primary"},{nav:n(()=>[r(_,{onActivate:s[0]||(s[0]=o=>e.activeTab=o),"active-classes":e.tabActiveClasses,"tab-controller":e.activeTab,tab:"basic-info"},{default:n(()=>[ae]),_:1},8,["active-classes","tab-controller"]),r(_,{onActivate:s[1]||(s[1]=o=>e.activeTab=o),"active-classes":e.tabActiveClasses,"tab-controller":e.activeTab,tab:"assign-roles"},{default:n(()=>[le]),_:1},8,["active-classes","tab-controller"]),r(_,{onActivate:s[2]||(s[2]=o=>e.activeTab=o),"active-classes":e.tabActiveClasses,"tab-controller":e.activeTab,tab:"assign-establishments"},{default:n(()=>[ne]),_:1},8,["active-classes","tab-controller"])]),content:n(()=>[r(g,{name:"basic-info","tab-controller":e.activeTab},{default:n(()=>[l("form",{onSubmit:s[8]||(s[8]=v((...o)=>c.updateModel&&c.updateModel(...o),["prevent"]))},[l("div",ie,[r(m,{for:"name",value:"Name"}),r(u,{class:d(["w-full",{"border-red-500 sm:focus:border-red-300 sm:focus:ring-red-100":e.form.errors.name}]),type:"text",id:"name",name:"name",modelValue:e.form.name,"onUpdate:modelValue":s[3]||(s[3]=o=>e.form.name=o)},null,8,["modelValue","class"]),r(f,{message:e.form.errors.name,class:"mt-2"},null,8,["message"])]),l("div",ce,[r(m,{for:"email",value:"Email"}),r(u,{class:d(["w-full",{"border-red-500 sm:focus:border-red-300 sm:focus:ring-red-100":e.form.errors.email}]),type:"text",id:"email",name:"email",modelValue:e.form.email,"onUpdate:modelValue":s[4]||(s[4]=o=>e.form.email=o)},null,8,["modelValue","class"]),r(f,{message:e.form.errors.email,class:"mt-2"},null,8,["message"])]),l("div",me,[r(m,{for:"password",value:"Password"}),r(u,{class:d(["w-full",{"border-red-500 sm:focus:border-red-300 sm:focus:ring-red-100":e.form.errors.password}]),type:"password",id:"password",name:"password",modelValue:e.form.password,"onUpdate:modelValue":s[5]||(s[5]=o=>e.form.password=o)},null,8,["modelValue","class"]),r(f,{message:e.form.errors.password,class:"mt-2"},null,8,["message"])]),l("div",de,[r(m,{for:"password_confirmation",value:"Repeat Password"}),r(u,{class:d(["w-full",{"border-red-500 sm:focus:border-red-300 sm:focus:ring-red-100":e.form.errors.password_confirmation}]),type:"password",id:"password_confirmation",name:"password_confirmation",modelValue:e.form.password_confirmation,"onUpdate:modelValue":s[6]||(s[6]=o=>e.form.password_confirmation=o)},null,8,["modelValue","class"])]),l("div",pe,[l("input",{type:"file",class:"hidden",ref:"photo",onChange:s[7]||(s[7]=(...o)=>c.updatePhotoPreview&&c.updatePhotoPreview(...o))},null,544),r(m,{for:"photo",value:"Photo"}),C(l("div",ue,[l("img",{src:e.form.profile_photo_url,alt:e.form.first_name,class:"rounded-full h-20 w-20 object-cover"},null,8,fe)],512),[[T,!e.photoPreview]]),C(l("div",he,[l("span",{class:"block rounded-full w-20 h-20",style:q("background-size: cover; background-repeat: no-repeat; background-position: center center; background-image: url('"+e.photoPreview+"');")},null,4)],512),[[T,e.photoPreview]]),r(w,{class:"mt-2 mr-2",type:"button",onClick:v(c.selectNewPhoto,["prevent"])},{default:n(()=>[be]),_:1},8,["onClick"]),e.form.profile_photo_path?(h(),V(w,{key:0,type:"button",class:"mt-2",onClick:v(c.deletePhoto,["prevent"])},{default:n(()=>[_e]),_:1},8,["onClick"])):K("",!0),r(f,{message:e.photo_form.errors.photo,class:"mt-2"},null,8,["message"])]),l("div",ge,[r(I,{type:"submit",class:"bg-primary font-semibold text-white",disabled:e.form.processing},{default:n(()=>[ve]),_:1},8,["disabled"])])],32)]),_:1},8,["tab-controller"]),r(g,{name:"assign-roles","tab-controller":e.activeTab},{default:n(()=>[l("div",we,[ke,je,l("div",ye,[(h(!0),A(G,null,Y(e.form.assigned_roles,(o,E)=>(h(),A("div",{style:{cursor:"pointer"},key:E,class:"sm:col-span-4 px-10 flex border-b border-gray-100 justify-between py-3 items-center my-2"},[r(m,{for:o.name,class:"inline-block font-black text-xl",value:o.title},null,8,["for","value"]),r(U,{onChange:k=>c.toggleRole(o),class:d(["p-2 inline-block",{"border-red-500 sm:focus:border-red-300 sm:focus:ring-red-100":e.form.errors.assigned_roles}]),type:"checkbox",id:o.name,name:o.name,checked:o.checked,modelValue:o.checked,"onUpdate:modelValue":k=>o.checked=k},null,8,["onChange","id","name","checked","modelValue","onUpdate:modelValue","class"])]))),128))])])]),_:1},8,["tab-controller"]),r(g,{name:"assign-establishments","tab-controller":e.activeTab},{default:n(()=>[r(F,{user:a.model,establishments:a.establishments},null,8,["user","establishments"])]),_:1},8,["tab-controller"])]),_:1})}var Me=te(re,[["render",xe]]);export{Me as default};
