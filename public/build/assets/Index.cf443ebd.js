import{J as q}from"./JigLayout.de448839.js";import{J as S}from"./ConfirmationModal.076d1b58.js";import{J as I}from"./DialogModal.12166fb1.js";import{I as U}from"./InertiaButton.18e5489b.js";import{D as O,J as x,a as $}from"./DtComponent.3ba239b7.js";import{D as J}from"./DisplayMixin.328c366f.js";import L from"./ShowForm.8ce715fe.js";import{p as N,K as R,e as c,o as r,f as b,w as i,g as o,k as a,i as u,n as d,t as v,j as p,C as P,z as k,a6 as y,D as B,E as A}from"./vendor.faa38336.js";import{J as E}from"./Input.ff5f863b.js";import{J as T}from"./Label.b121d9c9.js";import{I as H}from"./InfiniteSelect.ea8cf2aa.js";import{f as z}from"./vue-flatpickr.min.fb0f0e25.js";import"./main.5bc2c5ec.js";import Y from"./ShowForm.bd706196.js";import{_ as K}from"./plugin-vue_export-helper.5a098b48.js";import"./ApplicationLogo.d162e8a5.js";import"./JigDd.3af5bc62.js";const Q=N({name:"Index",components:{DtComponent:O,JigToggle:x,InertiaButton:U,JetConfirmationModal:S,JetDialogModal:I,JigModal:$,JigLayout:q,ShowStockHistoriesForm:L,JetLabel:T,InfiniteSelect:H,JetInput:E,flatPickr:z,ShowStocksForm:Y},props:{can:Object,columns:Array,columnDefs:Array,stock:Object},inject:["$refreshDt","$dayjs"],data(){return{tableId:"stock-histories-dt",tableParams:{estum_id:null,type:null,region_id:null,etab_id:null,detaine_id:null,code:null,code_condition:"equal",medicament_id:null,stock_id:null,date_from:null,date_to:null,quantite:null,condition:"equal"},tableParamsForm:R({estum:null,type:null,region:null,etab:null,detaine:null,code:null,code_condition:"equal",medicament:null,stock:null,date_from:null,date_to:null,quantite:null,condition:"equal"},{remember:!1}),datatable:null,confirmDelete:!1,currentModel:null,withDisabled:!1,showModal:!1,filters_expanded:!1,code_label:"N\xB0 Bulletin",extends_info:!1}},mixins:[J],mounted(){},computed:{ajaxUrl(){const e=new URL(this.route("api.stock-histories.dt"));return this.stock&&(e.searchParams.append("stock_id",this.stock.id),this.tableParamsForm.stock=this.stock,this.tableParams.stock_id=this.stock.id),e.href}},methods:{showModel(e){axios.get(route("api.stock-histories.show",e)).then(t=>{this.currentModel=t.data.payload,this.showModal=!0})},editModel(e){this.$inertia.visit(this.route("admin.stock-histories.edit",e.id))},confirmDeletion(e){this.currentModel=e,this.confirmDelete=!0},cancelDelete(){this.currentModel=!1,this.confirmDelete=!1},async deleteModel(){const e=this;this.confirmDelete=!1,this.currentModel&&this.$inertia.delete(route("admin.stock-histories.destroy",e.currentModel),{onFinish:t=>{this.displayNotification("success","Item deleted."),e.$refreshDt(e.tableId)},onError:t=>{console.log(t),this.displayNotification("error","There was an error while deleting the item.")}})},async toggleActivation(e,t){axios.put(route("api.stock-histories.update",t.id),{enabled:e}).then(n=>{this.displayNotification("success",n.data.message),this.$refreshDt(this.tableId)})},expandFilters(){this.filters_expanded=!this.filters_expanded},onTypeChange(e){e.target.value!=""&&(e.target.value=="consommation"?this.code_label="N\xB0 Ordonnance":e.target.value=="achats"?this.code_label="Bon d'achat":e.target.value=="detruit"?this.code_label="N\xB0 PV":this.code_label="N\xB0 Bulletin")},submmitFilters(){this.tableParams.type=this.tableParamsForm.type?this.tableParamsForm.type:null,this.tableParams.estum_id=this.tableParamsForm.estum?this.tableParamsForm.estum.id:null,this.tableParams.region_id=this.tableParamsForm.region?this.tableParamsForm.region.id:null,this.tableParams.etab_id=this.tableParamsForm.etab?this.tableParamsForm.etab.id:null,this.tableParams.detaine_id=this.tableParamsForm.detaine?this.tableParamsForm.detaine.id:null,this.tableParams.medicament_id=this.tableParamsForm.medicament?this.tableParamsForm.medicament.id:null,this.stock==null&&(this.tableParams.stock_id=this.tableParamsForm.stock?this.tableParamsForm.stock.id:null),this.tableParams.date_from=this.tableParamsForm.date_from?this.tableParamsForm.date_from:null,this.tableParams.date_to=this.tableParamsForm.date_to?this.tableParamsForm.date_to:null,this.tableParams.quantite=this.tableParamsForm.quantite?this.tableParamsForm.quantite:null,this.tableParams.condition=this.tableParamsForm.condition?this.tableParamsForm.condition:"equal",this.tableParams.code=this.tableParamsForm.code?this.tableParamsForm.code:null,this.tableParams.code_condition=this.tableParamsForm.code_condition?this.tableParamsForm.code_condition:"equal",this.$refreshDt(this.tableId)},ResetFillters(){this.tableParamsForm.estum=null,this.tableParamsForm.type=null,this.tableParamsForm.region=null,this.tableParamsForm.etab=null,this.tableParamsForm.detaine=null,this.tableParamsForm.code=null,this.tableParamsForm.code_condition="equal",this.tableParamsForm.medicament=null,this.stock==null&&(this.tableParamsForm.stock=null),this.tableParamsForm.date_from=null,this.tableParamsForm.date_to=null,this.tableParamsForm.quantite=null,this.tableParamsForm.condition="equal",this.submmitFilters()},stockChanged(){this.submmitFilters()},async print(){this.stock&&(this.tableParams.stock_id=this.stock.id),await axios.get(this.route("api.stock-histories.print",this.tableParams),{responseType:"blob"}).then(e=>{this.displayNotification("success","Stock Histories Printed");const t=new Blob([e.data],{type:"application/pdf"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="stock-histories.pdf",n.click(),URL.revokeObjectURL(n.href)}).catch(e=>{var t,n;this.displayNotification("error",((n=(t=e.response)==null?void 0:t.data)==null?void 0:n.message)||e.message||e)}).finally(e=>{})},expandInfo(){this.extends_info=!this.extends_info},async _export(){await axios.get(this.route("api.stock-histories.export",this.tableParams),{responseType:"blob"}).then(e=>{this.displayNotification("success","Stock Histories Exported");const t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="stock-histories.xlsx",n.click(),URL.revokeObjectURL(n.href)}).catch(e=>{var t,n;this.displayNotification("error",((n=(t=e.response)==null?void 0:t.data)==null?void 0:n.message)||e.message||e)}).finally(e=>{})}}}),l=e=>(B("data-v-1ae59b1c"),e=e(),A(),e),G={class:"flex flex-wrap items-center justify-between w-full px-4"},W=l(()=>o("i",{class:"fas fa-arrow-left"},null,-1)),X=d(" Back"),Z=l(()=>o("i",{class:"fas fa-arrow-left"},null,-1)),ee=d(" Back"),te={class:"flex gap-x-2"},oe=l(()=>o("i",{class:"fas fa-redo"},null,-1)),se=d(" Refresh"),ae=l(()=>o("i",{class:"fas fa-print"},null,-1)),le=d(" Print"),ie=l(()=>o("i",{class:"far fa-file-excel"},null,-1)),ne=d(" Export"),re={key:0,class:"flex flex-wrap px-4"},de={class:"w-full z-10 flex-auto bg-white md:rounded-md md:shadow-md"},me={class:"w-full p-4 text-lg font-black sm:rounded-t-lg bg-primary-100"},ue=l(()=>o("i",{class:"mr-2 fas fa-bars"},null,-1)),ce=d(" List of All Stock Histories "),pe={key:0,class:"fas fa-angle-down"},fe={key:1,class:"fas fa-angle-up"},he=l(()=>o("i",{class:"mr-2 fas fa-filter"},null,-1)),be=[he],_e={key:0,class:"gap-4 p-4"},ve={key:1,class:"p-4 transition-all bg-indigo-50"},Pe={class:"flex"},ke={class:"flex-1 mr-2"},ye={class:"w-full max-w-md"},Fe={class:"flex-1 mr-2"},ge={class:"max-w-md"},we=l(()=>o("option",{value:""},"Select Action type ...",-1)),je=l(()=>o("option",{value:"dr_provenance"},"Provenance de la DR ",-1)),Me=l(()=>o("option",{value:"etab_provenance"},"Provenance d'un \xE9tablissement",-1)),De=l(()=>o("option",{value:"achats"},"Achats",-1)),Ve=l(()=>o("option",{value:"etab_transfere"},"Envoy\xE9 \xE0 un \xE9tablissment",-1)),Ce=l(()=>o("option",{value:"consommation"},"Consommation",-1)),qe=l(()=>o("option",{value:"detruit"},"D\xE9truit",-1)),Se=l(()=>o("option",{value:"update"},"Mettre \xE0 jour direct de stock",-1)),Ie=[we,je,Me,De,Ve,Ce,qe,Se],Ue={key:0,class:"flex-1 mr-2"},Oe={class:"w-full max-w-md"},xe={key:1,class:"flex-1 mr-2"},$e={class:"w-full max-w-md"},Je={key:2,class:"flex-1"},Le={class:"w-full max-w-md"},Ne={class:"flex mt-2"},Re={key:0,class:"flex-1"},Be={class:"flex"},Ae={class:"flex-1 mr-2"},Ee={class:"w-full max-w-md"},Te={class:"flex-1 mr-8"},He={class:"w-full max-w-xs"},ze=l(()=>o("option",{value:"equal"},"\xC9gale =",-1)),Ye=l(()=>o("option",{value:"contain"},"Contenir *",-1)),Ke=[ze,Ye],Qe={class:"flex-1 mr-2"},Ge={class:"w-full max-w-md"},We={key:1,class:"flex-1"},Xe={class:"w-full max-w-md"},Ze={class:"flex mt-2"},et={class:"flex-initial mr-6"},tt={class:"flex-initial"},ot={class:"flex-1 ml-14"},st={class:"flex"},at={class:"-mr-8 flex-initial mr-10"},lt={class:"w-full max-w-xs"},it={class:"flex-initial ml-12"},nt={class:"w-full max-w-xs"},rt=l(()=>o("option",{value:"equal"},"\xC9gale =",-1)),dt=l(()=>o("option",{value:"higher"},"Sup\xE9rieure >",-1)),mt=l(()=>o("option",{value:"less"},"Inf\xE9rieur <",-1)),ut=[rt,dt,mt],ct={class:"flex-none"},pt=d("Reset"),ft=d("Submit"),ht={class:"p-4"},bt=l(()=>o("div",null,"Are you sure you want to delete this record?",-1)),_t={class:"flex justify-end gap-x-2"},vt=d("Cancel"),Pt=d("Yes, Delete"),kt={key:2},yt=d("Close"),Ft={key:1,class:"p-4 font-bold text-red-500 bg-red-100 rounded-md shadow-md"};function gt(e,t,n,wt,jt,Mt){const _=c("inertia-link"),f=c("inertia-button"),w=c("show-stocks-form"),m=c("jet-label"),h=c("infinite-select"),F=c("jet-input"),g=c("flat-pickr"),j=c("dt-component"),M=c("jet-confirmation-modal"),D=c("show-stock-histories-form"),V=c("jig-modal"),C=c("jig-layout");return r(),b(C,null,{header:i(()=>[o("div",G,[e.stock?(r(),b(_,{key:0,href:e.route("admin.stocks.index"),class:"text-xl font-black text-white"},{default:i(()=>[W,X]),_:1},8,["href"])):(r(),b(_,{key:1,href:e.route("admin.dashboard"),class:"text-xl font-black text-white"},{default:i(()=>[Z,ee]),_:1},8,["href"])),o("div",te,[a(f,{onClick:t[0]||(t[0]=s=>e.$refreshDt(e.tableId)),classes:"bg-indigo-100 hover:bg-green-200 text-indigo my-2"},{default:i(()=>[oe,se]),_:1}),a(f,{disabled:!1,onClick:t[1]||(t[1]=s=>e.print()),classes:"bg-purple-500 hover:bg-purple-300 text-white my-2"},{default:i(()=>[ae,le]),_:1}),a(f,{disabled:!1,onClick:t[2]||(t[2]=s=>e._export()),classes:"bg-green-500 hover:bg-green-300 text-white my-2"},{default:i(()=>[ie,ne]),_:1})])])]),default:i(()=>[e.can.viewAny?(r(),u("div",re,[o("div",de,[o("h3",me,[ue,ce,e.stock?(r(),b(_,{key:0,href:e.route("admin.stocks.show",e.stock.id),class:"text-xl font-black text-primary"},{default:i(()=>[d(" > "+v(e.stock.title),1)]),_:1},8,["href"])):p("",!0),e.stock?(r(),u("button",{key:1,style:{"margin-top":"-5px"},type:"button",onClick:t[3]||(t[3]=s=>e.expandInfo()),class:"pl-2 pt-1 pb-1 pr-1 transition duration-150 ease-in-out"},[e.extends_info?p("",!0):(r(),u("i",pe)),e.extends_info?(r(),u("i",fe)):p("",!0)])):p("",!0),o("button",{style:{"margin-top":"-5px"},class:"float-right pl-2 pt-1 pb-1 pr-1 bg-primary 0 text-white rounded hover:bg-primary-700 hover:shadow-lg focus:bg-primary-700 focus:shadow-lg active:bg-primary-800 active:shadow-lg transition duration-150 ease-in-out",type:"button",onClick:t[4]||(t[4]=s=>e.expandFilters())},be)]),e.stock&&e.extends_info?(r(),u("dl",_e,[a(w,{model:e.stock},null,8,["model"])])):p("",!0),e.filters_expanded?(r(),u("div",ve,[o("form",{onSubmit:t[20]||(t[20]=P((...s)=>e.submmitFilters&&e.submmitFilters(...s),["prevent"]))},[o("div",Pe,[o("div",ke,[o("div",ye,[a(m,{for:"estum",value:"\xC9tablissement"}),a(h,{"per-page":15,"api-url":e.route("api.establishments.index"),"onOption:selected":e.submmitFilters,id:"estum",name:"estum",modelValue:e.tableParamsForm.estum,"onUpdate:modelValue":t[5]||(t[5]=s=>e.tableParamsForm.estum=s),label:"name"},null,8,["api-url","onOption:selected","modelValue"])])]),o("div",Fe,[o("div",ge,[a(m,{for:"type",value:"Type d'Action"}),k(o("select",{class:"w-full cost_select","onUpdate:modelValue":t[6]||(t[6]=s=>e.tableParamsForm.type=s),id:"type",name:"type",onChange:t[7]||(t[7]=s=>e.onTypeChange(s))},Ie,544),[[y,e.tableParamsForm.type]])])]),e.tableParamsForm.type=="dr_provenance"?(r(),u("div",Ue,[o("div",Oe,[a(m,{for:"region",value:"Region"}),a(h,{"per-page":15,"api-url":e.route("api.regions.index"),"onOption:selected":e.submmitFilters,id:"region",name:"region",modelValue:e.tableParamsForm.region,"onUpdate:modelValue":t[8]||(t[8]=s=>e.tableParamsForm.region=s),label:"name"},null,8,["api-url","onOption:selected","modelValue"])])])):p("",!0),e.tableParamsForm.type=="etab_provenance"||e.tableParamsForm.type=="etab_transfere"?(r(),u("div",xe,[o("div",$e,[a(m,{for:"etab",value:"\xC9tablissement"}),a(h,{"per-page":15,"api-url":e.route("api.establishments.index"),queryParams:{all:!0,deferent_then:e.tableParamsForm.estum?e.tableParamsForm.estum.id:null},id:"etab",name:"etab",reaictivo:!0,"onOption:selected":e.submmitFilters,modelValue:e.tableParamsForm.etab,"onUpdate:modelValue":t[9]||(t[9]=s=>e.tableParamsForm.etab=s),label:"name"},null,8,["api-url","queryParams","onOption:selected","modelValue"])])])):p("",!0),e.tableParamsForm.type=="consommation"?(r(),u("div",Je,[o("div",Le,[a(m,{for:"detaine",value:"Detaine"}),a(h,{"per-page":15,"api-url":e.route("api.detainees.index"),queryParams:{selected_etab:e.tableParamsForm.estum?e.tableParamsForm.estum.id:null},id:"detaine",name:"detaine",reaictivo:!0,"onOption:selected":e.submmitFilters,modelValue:e.tableParamsForm.detaine,"onUpdate:modelValue":t[10]||(t[10]=s=>e.tableParamsForm.detaine=s),label:"title"},null,8,["api-url","queryParams","onOption:selected","modelValue"])])])):p("",!0)]),o("div",Ne,[e.tableParamsForm.type!=null&&e.tableParamsForm.type!=""&&e.tableParamsForm.type!="update"?(r(),u("div",Re,[o("div",Be,[o("div",Ae,[o("div",Ee,[a(m,{for:"code"},{default:i(()=>[d(v(e.code_label),1)]),_:1}),a(F,{class:"w-full",type:"text",id:"code",name:"code",modelValue:e.tableParamsForm.code,"onUpdate:modelValue":t[11]||(t[11]=s=>e.tableParamsForm.code=s)},null,8,["modelValue"])])]),o("div",Te,[o("div",He,[a(m,{for:"code_condition",value:"Condition"}),k(o("select",{class:"w-full cost_select","onUpdate:modelValue":t[12]||(t[12]=s=>e.tableParamsForm.code_condition=s),id:"code_condition",name:"code_condition"},Ke,512),[[y,e.tableParamsForm.code_condition]])])])])])):p("",!0),o("div",Qe,[o("div",Ge,[a(m,{for:"medicament",value:"Medicament"}),a(h,{"per-page":15,"api-url":e.route("api.medicaments.index"),"onOption:selected":e.submmitFilters,id:"medicament",name:"medicament",modelValue:e.tableParamsForm.medicament,"onUpdate:modelValue":t[13]||(t[13]=s=>e.tableParamsForm.medicament=s),label:"title"},null,8,["api-url","onOption:selected","modelValue"])])]),e.tableParamsForm.medicament?(r(),u("div",We,[o("div",Xe,[a(m,{for:"stock",value:"Stock"}),a(h,{"per-page":15,"api-url":e.route("api.stocks.index"),"onOption:selected":e.stockChanged,queryParams:{selected_etab:e.tableParamsForm.estum?e.tableParamsForm.estum.id:null,medicaments_id:e.tableParamsForm.medicament?e.tableParamsForm.medicament.id:null},id:"stock",name:"stock",modelValue:e.tableParamsForm.stock,"onUpdate:modelValue":t[14]||(t[14]=s=>e.tableParamsForm.stock=s),label:"title",reaictivo:!0},null,8,["api-url","onOption:selected","queryParams","modelValue"])])])):p("",!0)]),o("div",Ze,[o("div",et,[a(m,{for:"date_from",value:"Date : Du"}),a(g,{class:"cost_select",modelValue:e.tableParamsForm.date_from,"onUpdate:modelValue":t[15]||(t[15]=s=>e.tableParamsForm.date_from=s)},null,8,["modelValue"])]),o("div",tt,[a(m,{for:"date_to",value:"Jusqu'\xE0"}),a(g,{class:"cost_select",modelValue:e.tableParamsForm.date_to,"onUpdate:modelValue":t[16]||(t[16]=s=>e.tableParamsForm.date_to=s)},null,8,["modelValue"])]),o("div",ot,[o("div",st,[o("div",at,[o("div",lt,[a(m,{for:"quantite",value:"Quantite"}),a(F,{class:"w-full",type:"number",min:"0",step:"1",id:"quantite",name:"quantite",modelValue:e.tableParamsForm.quantite,"onUpdate:modelValue":t[17]||(t[17]=s=>e.tableParamsForm.quantite=s)},null,8,["modelValue"])])]),o("div",it,[o("div",nt,[a(m,{for:"condition",value:"Condition"}),k(o("select",{class:"w-full cost_select","onUpdate:modelValue":t[18]||(t[18]=s=>e.tableParamsForm.condition=s),id:"condition",name:"condition"},ut,512),[[y,e.tableParamsForm.condition]])])])])]),o("div",ct,[a(f,{type:"button",class:"mt-4 mr-4 text-white font-semibold bg-success disabled:opacity-25",onClick:t[19]||(t[19]=s=>e.ResetFillters())},{default:i(()=>[pt]),_:1}),a(f,{type:"submit",class:"mt-4 mr-14 text-white font-semibold bg-primary disabled:opacity-25"},{default:i(()=>[ft]),_:1})])])],32)])):p("",!0),o("div",ht,[a(j,{"table-id":e.tableId,"ajax-url":e.ajaxUrl,columns:e.columns,"ajax-params":e.tableParams,onShowModel:e.showModel,onEditModel:e.editModel,onDeleteModel:e.confirmDeletion,defaultOrderColumn:e.id,defaultOrderDirection:e.desc},null,8,["table-id","ajax-url","columns","ajax-params","onShowModel","onEditModel","onDeleteModel","defaultOrderColumn","defaultOrderDirection"])]),a(M,{title:"Confirm Deletion",show:e.confirmDelete},{content:i(()=>[bt]),footer:i(()=>[o("div",_t,[a(f,{as:"button",type:"button",onClick:P(e.cancelDelete,["stop"]),class:"bg-red-500"},{default:i(()=>[vt]),_:1},8,["onClick"]),a(f,{as:"button",type:"button",onClick:P(e.deleteModel,["prevent"]),class:"bg-green-500"},{default:i(()=>[Pt]),_:1},8,["onClick"])])]),_:1},8,["show"]),e.showModal&&e.currentModel?(r(),u("div",kt,[a(V,{show:e.showModal,"corner-class":"rounded-lg","position-class":"align-middle",onClose:t[22]||(t[22]=s=>{e.currentModel=null,e.showModal=!1})},{title:i(()=>[d("Show Stock History #"+v(e.currentModel.id),1)]),footer:i(()=>[a(f,{class:"px-4 text-white bg-primary",onClick:t[21]||(t[21]=s=>{e.showModal=!1,e.currentModel=null})},{default:i(()=>[yt]),_:1})]),default:i(()=>[a(D,{model:e.currentModel},null,8,["model"])]),_:1},8,["show"])])):p("",!0)])])):(r(),u("div",Ft," You are not authorized to view a list of Stock History "))]),_:1})}var Tt=K(Q,[["render",gt],["__scopeId","data-v-1ae59b1c"]]);export{Tt as default};
